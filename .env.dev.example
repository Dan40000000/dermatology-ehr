# =============================================================================
# DERMATOLOGY EHR - LOCAL DEVELOPMENT ENVIRONMENT
# =============================================================================
#
# Copy this file to .env.dev and adjust values as needed:
#   cp .env.dev.example .env.dev
#
# Then start the development stack:
#   docker compose -f docker-compose.dev.yml --env-file .env.dev up -d
#
# =============================================================================

# -----------------------------------------------------------------------------
# PostgreSQL Database
# -----------------------------------------------------------------------------
# Connection: localhost:5432
# These match the defaults in docker-compose.dev.yml
DB_HOST=localhost
DB_PORT=5432
DB_NAME=derm_dev
DB_USER=derm_dev
DB_PASSWORD=derm_dev
DB_SSL_ENABLED=false
DB_SSL_REJECT_UNAUTHORIZED=true

# Full connection string for convenience
DATABASE_URL=postgresql://derm_dev:derm_dev@localhost:5432/derm_dev

# -----------------------------------------------------------------------------
# Redis Cache
# -----------------------------------------------------------------------------
# Connection: localhost:6379
# No password in development for simplicity
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_URL=redis://localhost:6379

# -----------------------------------------------------------------------------
# Application Configuration
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=4000
API_URL=http://localhost:4000
FRONTEND_URL=http://localhost:5173

# Enable development features
DEBUG=true
ENABLE_API_DOCS=true
ENABLE_PLAYGROUND=true

# -----------------------------------------------------------------------------
# Authentication & Security
# -----------------------------------------------------------------------------
# Development-only secrets (DO NOT use in production!)
JWT_SECRET=dev-jwt-secret-not-for-production-use-change-me-in-prod
JWT_EXPIRY=1h
REFRESH_TOKEN_EXPIRY=7d

CSRF_SECRET=dev-csrf-secret-not-for-production-use-change-me-in-prod
SESSION_SECRET=dev-session-secret-not-for-production-use-change-me

# Relaxed rate limiting for development
RATE_LIMIT_WINDOW=60
RATE_LIMIT_MAX_REQUESTS=1000

# -----------------------------------------------------------------------------
# Email Configuration (Mailhog)
# -----------------------------------------------------------------------------
# Mailhog captures all emails for testing
# View emails at: http://localhost:8025
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=
FROM_EMAIL=dev@derm-ehr.local
FROM_NAME=Derm EHR (Dev)

# -----------------------------------------------------------------------------
# Storage Configuration (LocalStack S3)
# -----------------------------------------------------------------------------
# LocalStack provides a local S3-compatible API
# Endpoint: http://localhost:4566
STORAGE_PROVIDER=s3
AWS_REGION=us-east-1
AWS_S3_BUCKET=derm-dev-uploads
AWS_ACCESS_KEY_ID=test
AWS_SECRET_ACCESS_KEY=test

# LocalStack-specific endpoint (use this in your app config)
AWS_S3_ENDPOINT=http://localhost:4566
AWS_S3_FORCE_PATH_STYLE=true

# Local file storage fallback
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=52428800

# -----------------------------------------------------------------------------
# ClamAV Virus Scanning (Optional)
# -----------------------------------------------------------------------------
# Uncomment if you enable ClamAV in docker-compose.dev.yml
# CLAMAV_HOST=localhost
# CLAMAV_PORT=3310
VIRUS_SCAN_ENABLED=false

# -----------------------------------------------------------------------------
# Logging & Monitoring
# -----------------------------------------------------------------------------
LOG_LEVEL=debug

# Sentry is optional in development
# SENTRY_DSN=
# SENTRY_ENVIRONMENT=development

# -----------------------------------------------------------------------------
# AI Services (Optional)
# -----------------------------------------------------------------------------
OPENAI_API_KEY=
OPENAI_TRANSCRIBE_MODEL=gpt-4o-transcribe-diarize
OPENAI_NOTE_MODEL=gpt-4o
ANTHROPIC_API_KEY=
ANTHROPIC_NOTE_MODEL=claude-3-5-sonnet-20241022
AMBIENT_LIVE_TRANSCRIBE_ENABLED=true
AMBIENT_LIVE_TRANSCRIBE_MIN_INTERVAL_MS=5000
AMBIENT_LIVE_TRANSCRIBE_MODEL=gpt-4o-transcribe

# -----------------------------------------------------------------------------
# HIPAA Compliance (Simplified for Dev)
# -----------------------------------------------------------------------------
# Use a simple key for development
ENCRYPTION_KEY=dev-encryption-key-32-bytes-long
AUDIT_LOG_RETENTION_DAYS=30
PHI_ENCRYPTION_ENABLED=false

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
ENABLE_PATIENT_PORTAL=true
ENABLE_TELEHEALTH=true
ENABLE_MESSAGING=true
ENABLE_DOCUMENT_EXPORT=true

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Allow all local development origins
CORS_ORIGIN=http://localhost:5173,http://localhost:3000,http://127.0.0.1:5173
CORS_CREDENTIALS=true

# -----------------------------------------------------------------------------
# Docker Compose Port Overrides (Optional)
# -----------------------------------------------------------------------------
# Uncomment to change default ports if you have conflicts
# DB_PORT=5432
# REDIS_PORT=6379
# MAILHOG_SMTP_PORT=1025
# MAILHOG_UI_PORT=8025
# LOCALSTACK_PORT=4566
# ADMINER_PORT=8080
# CLAMAV_PORT=3310

# -----------------------------------------------------------------------------
# LocalStack Configuration (Optional)
# -----------------------------------------------------------------------------
# Set to 1 for verbose LocalStack logging
LOCALSTACK_DEBUG=0

# -----------------------------------------------------------------------------
# Adminer Configuration (Optional)
# -----------------------------------------------------------------------------
# Available themes: default, brade, bueltge, cvicebni-poansen,
# haeckel, hever, hydra, lucas-sandor, mvt, nette, ng9, pappu687,
# pepa-linha, pepa-linha-dark, rmsoft, rmsoft_blue
ADMINER_DESIGN=nette
