# ===========================================
# DERMATOLOGY EHR - LOCAL DEVELOPMENT ENVIRONMENT
# ===========================================
# Copy this file to .env.local and customize as needed:
#   cp .env.local.example .env.local
#
# This configuration is optimized for local development with
# Docker Compose services (postgres, clamav, localstack, etc.)
# ===========================================

# -----------------------------
# Database Configuration
# -----------------------------
# Local PostgreSQL running in Docker
DATABASE_URL=postgres://derm_dev:derm_dev@localhost:5432/derm_dev
DB_HOST=localhost
DB_PORT=5432
DB_NAME=derm_dev
DB_USER=derm_dev
DB_PASSWORD=derm_dev

# -----------------------------
# Application Configuration
# -----------------------------
NODE_ENV=development
PORT=4000
API_URL=http://localhost:4000
FRONTEND_URL=http://localhost:5173

# -----------------------------
# Authentication & Security
# -----------------------------
# IMPORTANT: These are for LOCAL DEV ONLY - never use in production
JWT_SECRET=local-dev-secret-change-in-production-min-64-chars-for-security
JWT_ISSUER=dermatology-ehr-dev
ACCESS_TOKEN_TTL_SEC=900
REFRESH_TOKEN_TTL_SEC=1209600
JWT_EXPIRY=15m
REFRESH_TOKEN_EXPIRY=7d

# Session (for dev, use simple secrets)
SESSION_SECRET=local-dev-session-secret-change-in-production
CSRF_SECRET=local-dev-csrf-secret-change-in-production

# Rate limiting (relaxed for development)
RATE_LIMIT_WINDOW=15
RATE_LIMIT_MAX_REQUESTS=1000

# Default password for seeded users (dev only)
DEFAULT_USER_PASSWORD=DevPassword123!

# -----------------------------
# Storage Configuration (LocalStack S3)
# -----------------------------
STORAGE_PROVIDER=s3
AWS_ACCESS_KEY_ID=test
AWS_SECRET_ACCESS_KEY=test
AWS_S3_BUCKET=derm-dev-uploads
AWS_REGION=us-east-1
AWS_S3_ENDPOINT=http://localhost:4566
AWS_S3_FORCE_PATH_STYLE=true

# Local storage fallback
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=52428800

# -----------------------------
# Email Configuration (Mailhog)
# -----------------------------
# Mailhog UI: http://localhost:8025
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=
EMAIL_FROM=noreply@dev.dermatology-ehr.local
FROM_EMAIL=noreply@dev.dermatology-ehr.local
FROM_NAME=Dermatology EHR (Dev)

# -----------------------------
# Redis Configuration (Optional)
# -----------------------------
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=

# -----------------------------
# Virus Scanning (ClamAV)
# -----------------------------
# Set USE_MOCK_CLAMAV=true to skip actual virus scanning in dev
USE_MOCK_CLAMAV=false
CLAMAV_HOST=localhost
CLAMAV_PORT=3310
CLAMAV_TIMEOUT_MS=4000
VIRUS_SCAN_ENABLED=true

# -----------------------------
# External Services (Mocked for Dev)
# -----------------------------
# Set these to true to use mock implementations
USE_MOCK_TWILIO=true
USE_MOCK_SLACK=true
USE_MOCK_TEAMS=true

# Twilio (leave empty to use mock)
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# AI Services (optional - falls back to mock if not provided)
OPENAI_API_KEY=
ANTHROPIC_API_KEY=

# Payment processing (leave empty for dev)
STRIPE_SECRET_KEY=
STRIPE_PUBLISHABLE_KEY=

# -----------------------------
# Feature Flags
# -----------------------------
ENABLE_AI_FEATURES=false
ENABLE_PATIENT_PORTAL=true
ENABLE_TELEHEALTH=true
ENABLE_MESSAGING=true
ENABLE_DOCUMENT_EXPORT=true

# -----------------------------
# HIPAA Compliance (Relaxed for Dev)
# -----------------------------
# IMPORTANT: Enable PHI encryption in staging/production
ENABLE_AUDIT_LOGGING=true
ENABLE_PHI_ENCRYPTION=false
PHI_ENCRYPTION_ENABLED=false
ENCRYPTION_KEY=dev-encryption-key-32-bytes-long
AUDIT_LOG_RETENTION_DAYS=30

# -----------------------------
# Multi-tenant Configuration
# -----------------------------
TENANT_HEADER=x-tenant-id
DEFAULT_TENANT_ID=dev-tenant

# -----------------------------
# Monitoring & Logging
# -----------------------------
LOG_LEVEL=debug
SENTRY_DSN=
SENTRY_ENVIRONMENT=development

# -----------------------------
# Development/Debug Options
# -----------------------------
DEBUG=true
ENABLE_API_DOCS=true
ENABLE_PLAYGROUND=true

# -----------------------------
# CORS Configuration
# -----------------------------
CORS_ORIGIN=http://localhost:5173,http://localhost:4000
CORS_CREDENTIALS=true

# -----------------------------
# Performance (Dev Settings)
# -----------------------------
NODE_OPTIONS=--max-old-space-size=2048
ENABLE_CLUSTERING=false

# -----------------------------
# Backup (Disabled for Dev)
# -----------------------------
BACKUP_ENABLED=false
